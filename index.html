<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-m">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychological Factors in Social Engineering</title>
    <!-- 1. Load Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Use the Inter font family */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Added transition for the bar graph */
        #result-bar {
            transition: width 0.5s ease-in-out;
        }
        /* Styles for the tabbed interfaces */
        .tab-button {
            transition: all 0.2s ease-in-out;
        }
        .tab-button:hover {
            background-color: #f8fafc; /* slate-50 */
            color: #1e40af; /* blue-800 */
        }
        .tab-button[aria-selected="true"] {
            border-color: #3b82f6; /* blue-500 */
            color: #1d4ed8; /* blue-700 */
            font-weight: 600;
        }
        .tab-panel.hidden {
            display: none;
        }
        /* Styling for the copy/share buttons */
        .action-button {
            display: inline-flex;
            align-items: center;
            padding: 6px 12px;
            font-size: 14px;
            font-weight: 500;
            border-radius: 6px;
            border: 1px solid #e2e8f0; /* slate-200 */
            background-color: #ffffff; /* white */
            color: #475569; /* slate-600 */
            transition: all 0.15s ease;
        }
        .action-button:hover {
            background-color: #f8fafc; /* slate-50 */
            color: #1e40af; /* blue-800 */
        }
        .action-button svg {
            margin-right: 6px;
        }
        /* Custom "Copied" Notification */
        #copy-notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            transition: opacity 0.3s ease, transform 0.3s ease;
            z-index: 50;
        }
        #copy-notification.hidden {
            opacity: 0;
            transform: translateX(-50%) translateY(20px);
            pointer-events: none;
        }
        /* Simple transition for new sections */
        .slide-down {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .slide-down.open {
            max-height: 500px; /* arbitrary large value */
        }
        /* Styling for the new results table */
        #trends-result-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
        }
        #trends-result-table th, #trends-result-table td {
            text-align: left;
            padding: 12px 16px;
            border-bottom: 1px solid #e2e8f0; /* slate-200 */
        }
        #trends-result-table th {
            background-color: #f8fafc; /* slate-50 */
            font-weight: 600;
            color: #334155; /* slate-700 */
            width: 30%;
        }
        #trends-result-table td {
            color: #1e293b; /* slate-800 */
            font-weight: 500;
        }
    </style>
    <!-- Import Inter font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="bg-slate-100 min-h-screen p-4 md:p-8 flex flex-col">

    <!-- Centered, single-column layout -->
    <div class="max-w-4xl mx-auto w-full">
        <header class="mb-8">
            <h1 class="text-2xl md:text-3xl font-bold text-slate-800 text-center">
                Psychological Factors and their influence in Social Engineering based on Undetected Vulnerabilities
            </h1>
            <p class="text-slate-500 text-center mt-2 text-lg">An Internal Database & Research Tool</p>
        </header>

        <main class="flex flex-col gap-8">

            <!-- SECTION 1: INTERNAL DATABASE LOOKUP (with Bar Graph) -->
            <section class="bg-white rounded-xl shadow-2xl p-6 md:p-8 flex flex-col">
                <h2 class="text-2xl font-bold text-slate-800 mb-2">Internal Database Lookup</h2>
                <p class="text-slate-500 mb-6">Data from "Psych factors.pdf" (Aniqa Afzal, 2025)</p>
                <div class="mb-6">
                    <label for="select-factor" class="block text-lg font-medium text-slate-700 mb-3">Select a Psychological Factor</label>
                    <select id="select-factor" class="w-full p-4 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 text-base">
                        <!-- Options will be populated by JS -->
                    </select>
                </div>
                
                <!-- Result Display (Now with Bar Graph) -->
                <div class="flex-grow flex flex-col justify-center p-8 min-h-[150px] bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg shadow-xl">
                    <div id="result-placeholder" class="text-blue-100 text-xl text-center">Please select a factor</div>
                    
                    <!-- Main percentage display -->
                    <div id="result-display" class="hidden">
                        <div class="text-center">
                            <div id="result-value" class="text-white font-extrabold text-7xl md:text-8xl"></div>
                            <div id="result-label" class="text-blue-200 text-lg font-medium mt-1">% contribution in Social Engineering scams</div>
                        </div>
                        
                        <!-- Bar Graph Visualization -->
                        <div class="mt-6 px-4">
                            <p class="text-white/90 text-sm font-medium mb-2">Contribution Visualization</p>
                            <div class="w-full bg-blue-900/50 rounded-full h-4 shadow-inner overflow-hidden">
                                <div id="result-bar" class="bg-white h-4 rounded-full" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION 2: CIALDINI'S 6 PRINCIPLES OF PERSUASION -->
            <section id="cialdini-section" class="bg-white rounded-xl shadow-2xl p-6 md:p-8">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">Cialdini's 6 Principles of Persuasion</h2>
                    <p class="text-slate-500">Definitions, examples, and prevention tips based on source research.</p>
                </div>

                <!-- Tab Headers -->
                <div class="border-b border-slate-200">
                    <nav id="cialdini-tabs-container" class="-mb-px flex space-x-6 overflow-x-auto" aria-label="Tabs">
                        <button role="tab" aria-selected="true" data-tab-target="cialdini-authority" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Authority</button>
                        <button role="tab" aria-selected="false" data-tab-target="cialdini-urgency" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Urgency (Scarcity)</button>
                        <button role="tab" aria-selected="false" data-tab-target="cialdini-liking" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Liking</button>
                        <button role="tab" aria-selected="false" data-tab-target="cialdini-reciprocity" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Reciprocity</button>
                        <button role="tab" aria-selected="false" data-tab-target="cialdini-consistency" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Consistency</button>
                        <button role="tab" aria-selected="false" data-tab-target="cialdini-social-proof" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Social Proof</button>
                    </nav>
                </div>

                <!-- Tab Content Panels -->
                <div id="cialdini-content-container" class="py-6">
                    <!-- Panel 1: Authority -->
                    <div id="cialdini-authority" role="tabpanel" class="tab-panel">
                        <div id="content-cialdini-authority" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Definition: The Principle of Authority</h3>
                            <p>People are conditioned to obey figures of authority. Scammers exploit this by impersonating individuals in positions of power (e.g., CEOs, IT administrators, police officers) to make their demands seem legitimate and non-negotiable.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Example Scam: "CEO Fraud / Business Email Compromise"</h3>
                            <p>An employee in finance receives an email that appears to come directly from the CEO. The email, marked "URGENT," demands an immediate, confidential wire transfer to a new "vendor." The employee, intimidated by the CEO's authority, bypasses normal procedures and sends the money, resulting in a direct financial loss.</p>
                            <h3 class="font-bold text-slate-800 mt-4">3. Preventive Measures & Recommendations</h3>
                            <ul class="list-disc pl-6">
                                <li>**Verify, Don't Trust:** Always verify high-stakes requests (like wire transfers) through a separate, known communication channel (e.g., call the person on their internal extension).</li>
                                <li>**Clear Protocols:** Establish multi-factor approval processes for all financial transactions that cannot be bypassed by a single individual, regardless of their "authority."</li>
                            </ul>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-cialdini-authority"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-cialdini-authority"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Cialdini, R. B. (2001). Harnessing the science of persuasion. *Harvard Business Review*, *79*(9), 72-79.</p>
                        </footer>
                    </div>
                    <!-- Panel 2: Urgency (Scarcity) -->
                    <div id="cialdini-urgency" role="tabpanel" class="tab-panel hidden">
                        <div id="content-cialdini-urgency" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Definition: The Principle of Scarcity (Urgency)</h3>
                            <p>This principle suggests that people are more likely to act when they believe an opportunity is limited or that they are about to lose something. Scammers create a false sense of urgency to rush victims into making mistakes before they have time to think critically.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Example Scam: "Password Expiration Notice"</h3>
                            <p>An employee receives an email seemingly from "IT Support" with the subject line: "ACTION REQUIRED: Your Account Password Expires in 15 Minutes." The email states that failure to update will result in being locked out. It provides a link to a fake login page, resulting in credential theft (data loss).</p>
                            <h3 class="font-bold text-slate-800 mt-4">3. Preventive Measures & Recommendations</h3>
                            <ul class="list-disc pl-6">
                                <li>**Be Suspicious of Pressure:** Treat any unexpected, urgent request with immediate suspicion. Legitimate organizations rarely give you a 15-minute deadline for critical actions.</li>
                                <li>**Never Click Links in Emails:** Always navigate to official websites or internal portals by typing the address yourself.</li>
                                <li>**MFA (Multi-Factor Authentication):** Enable MFA wherever possible.</li>
                            </ul>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-cialdini-urgency"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-cialdini-urgency"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Cialdini, R. B. (2001). Harnessing the science of persuasion. *Harvard Business Review*, *79*(9), 72-79.</p>
                        </footer>
                    </div>
                    <!-- Panel 3: Liking -->
                    <div id="cialdini-liking" role="tabpanel" class="tab-panel hidden">
                        <div id="content-cialdini-liking" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Definition: The Principle of Liking</h3>
                            <p>People are more likely to comply with requests from those they know and like. Scammers exploit this by building rapport, claiming to have mutual friends, or using compliments (Liking) and claiming similarities (Familiarity) to lower a victim's guard before making their request.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Example Scam: "LinkedIn / Social Media Phishing"</h3>
                            <p>An attacker researches an employee on LinkedIn and finds they went to the same university. The attacker sends a connection request with a message: "Hi! I see we both graduated from [University Name]!" After the victim accepts, the attacker builds rapport before sending a link to "helpful industry report," which is actually malware, resulting in a data breach.</p>
                            <h3 class="font-bold text-slate-800 mt-4">3. Preventive Measures & Recommendations</h3>
                            <ul class="list-disc pl-6">
                                <li>**Be Wary of Unsolicited Kindness:** Be cautious if a new, unsolicited contact quickly pivots to asking for information or for you to click a link.</li>
                                <li>**Compartmentalize Information:** Be mindful of what information you share publicly on social media, as it can all be used to build a "Liking" or "Familiarity" profile for an attack.</li>
                            </ul>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-cialdini-liking"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-cialdini-liking"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Cialdini, R. B. (2001). Harnessing the science of persuasion. *Harvard Business Review*, *79*(9), 72-79.</p>
                        </footer>
                    </div>
                    <!-- Panel 4: Reciprocity -->
                    <div id="cialdini-reciprocity" role="tabpanel" class="tab-panel hidden">
                        <div id="content-cialdini-reciprocity" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Definition: The Principle of Reciprocity</h3>
                            <p>Humans feel indebted to those who do something for them. Attackers exploit this by offering something "free" or a "small favor" upfront (Quid Pro Quo). Once the victim accepts the "gift," the scammer makes their real request, and the victim feels a psychological obligation to comply.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Example Scam: "Free USB Stick / Quid Pro Quo"</h3>
                            <p>An attacker leaves several "lost" USB sticks labeled "Confidential 2025 Salaries" in the company parking lot. An employee finds one and plugs it into their work computer. The USB stick immediately executes malware, compromising the entire network. The "gift" of the USB stick led to a massive data breach.</p>
                            <h3 class="font-bold text-slate-800 mt-4">3. Preventive Measures & Recommendations</h3>
                            <ul class="list-disc pl-6">
                                <li>**Physical Security Policy:** Have a strict, clear-cut policy: **Never** plug in unknown or untrusted media (USBs, CDs, etc.) into a company device.</li>
                                <li>**Reject Unsolicited "Gifts":** Train staff to be suspicious of unsolicited "free" offers online, whether they are "free reports" or physical items.</li>
                            </ul>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-cialdini-reciprocity"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-cialdini-reciprocity"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Cialdini, R. B. (2001). Harnessing the science of persuasion. *Harvard Business Review*, *79*(9), 72-79.</p>
                        </footer>
                    </div>
                    <!-- Panel 5: Consistency -->
                    <div id="cialdini-consistency" role="tabpanel" class="tab-panel hidden">
                        <div id="content-cialdini-consistency" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Definition: The Principle of Consistency</h3>
                            <p>People feel a strong desire to be consistent with what they have previously said or done. Attackers exploit this by first asking for a small, simple commitment (the "foot-in-the-door" technique). Once the victim agrees, the attacker follows up with a larger, related request, which the victim feels psychologically pressured to accept to remain consistent.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Example Scam: "Fake Survey Scam"</h3>
                            <p>An attacker, posing as a market researcher, asks an employee to take a "quick 30-second survey" about their remote work software. The questions are harmless. A week later, the same "researcher" calls back, thanks the employee for their past help (invoking consistency), and asks for a "small follow-up" to "confirm" their account details, including their username and password. The employee, already committed to being "helpful," complies.</p>
                            <h3 class="font-bold text-slate-800 mt-4">3. Preventive Measures & Recommendations</h3>
                            <ul class="list-disc pl-6">
                                <li>**Recognize the "Foot-in-the-Door":** Be aware that a small, innocuous request is often the setup for a larger, more malicious one.</li>
                                <li>**It's OK to Say No:** Understand that you are not obligated to comply with a follow-up request, even if you complied with a smaller one.</li>
                                <li>**Never Share Credentials:** Enforce a strict policy that no employee should ever share their password with anyone, including IT staff, for any reason.</li>
                            </ul>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-cialdini-consistency"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-cialdini-consistency"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Cialdini, R. B. (2001). Harnessing the science of persuasion. *Harvard Business Review*, *79*(9), 72-79.</p>
                        </footer>
                    </div>
                    <!-- Panel 6: Social Proof (Consensus) -->
                    <div id="cialdini-social-proof" role="tabpanel" class="tab-panel hidden">
                        <div id="content-cialdini-social-proof" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Definition: The Principle of Social Proof</h3>
                            <p>People will look to the actions and behaviors of others to determine their own, especially in situations of uncertainty. Scammers exploit this by creating the illusion of consensus, suggesting that "everyone else" is doing something (e.g., "all other employees have updated") to pressure the victim into complying.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Example Scam: "Fake Software Update"</h3>
                            <p>An attacker sends an email to a department, spoofing the IT department, with a link to a "new, mandatory software update." To build social proof, the attacker includes a fake testimonial: "I just installed this, it works great! - John S., Accounting." An employee, seeing that a colleague has "vouched" for it, trusts the link, clicks it, and installs malware.</p>
                            <h3 class="font-bold text-slate-800 mt-4">3. Preventive Measures & Recommendations</h3>
                            <ul class="list-disc pl-6">
                                <li>**Centralized Updates:** Establish that all legitimate software updates will *only* come through official, automated channels (like managed software centers), not through email links.</li>
                                <li>**Verify Consensus:** Train employees that "everyone else is doing it" is a major red flag. Verify the request with the "source" (IT) or manager directly.</li>
                                <li>**Question Testimonials:** Be wary of testimonials in emails that you cannot independently verify.</li>
                            </ul>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-cialdini-social-proof"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-cialdini-social-proof"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Cialdini, R. B. (2001). Harnessing the science of persuasion. *Harvard Business Review*, *79*(9), 72-79.</p>
                        </footer>
                    </div>
                </div>
            </section>

            <!-- SECTION 3: NEW RESEARCH DASHBOARD -->
            <section id="dashboard-section" class="bg-white rounded-xl shadow-2xl p-6 md:p-8">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">Research Dashboard</h2>
                    <p class="text-slate-500">Key concepts from the source library (e.g., Eysenck, 1991; Burgoon & Buller, 1994).</p>
                </div>

                <!-- Tab Headers -->
                <div class="border-b border-slate-200">
                    <nav id="dashboard-tabs-container" class="-mb-px flex space-x-6 overflow-x-auto" aria-label="Tabs">
                        <button role="tab" aria-selected="true" data-tab-target="dashboard-vulnerability" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Vulnerability Models</button>
                        <button role="tab" aria-selected="false" data-tab-target="dashboard-deception" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Deception Cues</button>
                        <button role="tab" aria-selected="false" data-tab-target="dashboard-trends" class="tab-button py-4 px-1 border-b-2 border-transparent text-slate-500 hover:text-blue-700 hover:border-blue-300 text-base font-medium whitespace-nowrap">Attack Trends</button>
                    </nav>
                </div>

                <!-- Tab Content Panels -->
                <div id="dashboard-content-container" class="py-6">
                    <!-- Panel 1: Vulnerability Models -->
                    <div id="dashboard-vulnerability" role="tabpanel" class="tab-panel">
                        <div id="content-dashboard-vulnerability" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Personality Traits as Vulnerabilities</h3>
                            <p>Personality theory suggests certain traits can be exploited. For example, Eysenck's (1991) P-E-N model includes **Psychoticism** (cold, aggressive, impulsive), **Extraversion** (sociable, assertive), and **Neuroticism** (anxious, emotional). An attacker might exploit high "Extraversion" and "Liking" or trigger "Neuroticism" (anxiety) with a "Fear/Loss Aversion" tactic.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Manipulation Tactics in Relationships</h3>
                            <p>Buss (1992) identified tactics used in close relationships that scammers mimic. These include **Coercion** (demands, threats), **Reason** (using logic, however flawed), and **Pleasure Induction** (promising rewards). An attacker might use "Pleasure Induction" by promising a "bonus" (Greed) or "Coercion" by "Intimidation."</P>
                            <h3 class="font-bold text-slate-800 mt-4">3. Implications for Prevention</h3>
                            <ul class="list-disc pl-6">
                                <li>**Self-Awareness:** Understanding that innate personality traits (like being helpful or anxious) can be exploited is the first step in defense.</li>
                                <li>**Training:** Security awareness can be tailored to show how different tactics (Coercion, Reason) map to common attacks (impersonation, phishing).</li>
                            </ul>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-dashboard-vulnerability"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-dashboard-vulnerability"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Eysenck, H. J. (1991). Dimensions of personality: 16, 5 or 3?. *Personality and Individual Differences*, *12*(8), 773-790. & Buss, D. M. (1992). Manipulation in close relationships. *Journal of Personality andSocial Psychology*, *63*(5), 780-798.</p>
                        </footer>
                    </div>
                    <!-- Panel 2: Deception Cues -->
                    <div id="dashboard-deception" role="tabpanel" class="tab-panel hidden">
                        <div id="content-dashboard-deception" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Interpersonal Deception Theory (IDT)</h3>
                            <p>Burgoon & Buller (1994) explain that deception is an *interactive* process. Deceivers (scammers) must actively manage their image and behavior to appear credible. This can lead to "leakage" cues.</p>
                            <h3 class="font-bold text-slate-800 mt-4">2. Common Cues of Deception</h3>
                            <p>While there is no single "Pinocchio" sign, IDT identifies patterns that can be red flags in a interaction (like a vishing call or phishing email):</p>
                            <ul class="list-disc pl-6">
                                <li>**Vagueness:** Deceivers are often uncertain and vague, offering fewer details than a truthful person would.</li>
                                <li>**Nonimmediacy:** They may seem detached, using fewer "I" statements, and creating psychological distance.</li>
                                <li>**Negative Affect:** Deception is stressful. The scammer may seem more tense, aroused, or display "non-composure" (e.g., being overly rigid or fidgety).</li>
                                <li>**Image Management:** They may over-compensate by being *too* smooth or *too* polite, which can feel "off."</li>
                            </ul>
                            <h3 class="font-bold text-slate-800 mt-4">3. Preventive Measures & Recommendations</h3>
                            <p>In a text-based scam (email/SMS), look for:
                                <li>**Vagueness:** "An urgent matter with your account." (Which account? What matter?)</li>
                                <li>**Nonimmediacy:** "It is required that this link is clicked." (Passive voice, no "I".)</li>
                                <li>**Negative Affect (Pressure):** "Failure to comply will result in immediate suspension!" (A form of tension and intimidation).</li>
                            </p>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-dashboard-deception"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-dashboard-deception"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Burgoon, J. K., & Buller, D. B. (1994). Interpersonal deception: III. Effects of deceit on perceived communication and nonverbal behavior dynamics. *Communication Monographs*, *61*(4), 303-325.</p>
                        </footer>
                    </div>
                    <!-- Panel 3: Attack Trends -->
                    <div id="dashboard-trends" role="tabpanel" class="tab-panel hidden">
                        <div id="content-dashboard-trends" class="prose prose-lg max-w-none text-slate-700">
                            <h3 class="font-bold text-slate-800">1. Understanding the Victim's Perspective</h3>
                            <p>Online frauds are a major global problem. Research into victims (Button et al., 2014) shows they fall for scams for several reasons that overlap directly with psychological principles:</p>
                            <ul class="list-disc pl-6">
                                <li>**Authority & Legitimacy:** Scammers are effective at displaying "authority and legitimacy" (e.g., fake credentials, professional websites).</li>
                                <li>**Visceral Appeals:** They use "visceral appeals" (e.g., "Fear/Loss Aversion" or "Attraction").</li>
                                <li>**Pressure & Coercion:** Many victims report feeling pressured or coerced, which aligns with "Urgency" and "Intimidation."</li>
                                <li>**Grooming:** Scammers build rapport over time, similar to Cialdini's "Liking" and "Consistency" principles.</li>
                            </ul>
                            <h3 class="font-bold text-slate-800 mt-4">2. The "Human" Element as the Weakest Link</h3>
                            <p>Algarni et al. (2013) emphasize that social engineering's main goal is to "deceive and trick people to reveal critical information." This highlights that even with perfect technical defenses (firewalls, etc.), the human is often the target. Understanding this is key to building better defenses.</p>
                            <h3 class="font-bold text-slate-800 mt-4">3. Future Trends: AI-Powered Attacks</h3>
                            <p>While not in the 2013-2015 papers, a "future trend" is the use of AI to scale these attacks. AI can generate "Liking" (by mimicking writing styles) or "Urgency" (via deepfake "vishing") at a massive scale, making human-centric defenses more critical than ever.</p>
                        </div>
                        <footer class="mt-6 border-t pt-4">
                            <div class="flex gap-2">
                                <button class="action-button copy-btn" data-target="content-dashboard-trends"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>Copy</button>
                                <button class="action-button share-btn" data-target="content-dashboard-trends"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8.684 13.342C8.886 12.938 9 12.482 9 12s-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z" /></svg>Share</button>
                            </div>
                            <p class="text-xs text-slate-500 mt-4">Source (APA 7th ed.): Button, M., et al. (2014). Online frauds: Learning from victims why they fall for these scams. *Australian & New Zealand Journal of Criminology*, *47*(3), 391-408. & Algarni, A., et al. (2013). Toward understanding social engineering. *Proceedings of the 8th International Conference on Legal, Security and Privacy Issues in IT Law.*</p>
                        </footer>
                    </div>
                </div>
            </section>

            <!-- SECTION 4: NEW GLOBAL TRENDS DATABASE (PRE-LOADED) -->
            <section id="trends-section" class="bg-white rounded-xl shadow-2xl p-6 md:p-8">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">Global Trends of Evolving Social Engineering</h2>
                    <p class="text-slate-500 mb-4">by the Cyber Secure Behavior Lab at UMBC</p>
                    <p class="text-slate-500">Analyze pre-loaded incident data from your research (1968-2025).</p>
                </div>
                
                <!-- Database Controls -->
                <fieldset id="trends-controls" class="mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-1 gap-4">
                        <div>
                            <label for="trends-factor-select" class="block text-lg font-medium text-slate-700 mb-3">Select a Psychological Factor to Analyze</label>
                            <select id="trends-factor-select" class="w-full p-4 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 text-base">
                                <option value="default">Select a factor...</option>
                                <!-- JS will populate this -->
                            </select>
                        </div>
                    </div>
                </fieldset>
                
                <!-- Trends Result Display (Table) -->
                <div id="trends-result-display" class="hidden">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4">Analysis Report</h3>
                    <div class="border border-slate-200 rounded-lg overflow-hidden">
                        <table id="trends-result-table" class="min-w-full">
                            <tbody id="trends-result-tbody">
                                <!-- JS will populate this -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- SECTION 5: PDF SOURCE LIBRARY (With "Add New" Feature) -->
            <section id="references-section" class="bg-white rounded-xl shadow-2xl p-6 md:p-8">
                <div class="flex flex-wrap justify-between items-center gap-4 mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800">PDF Source Library</h2>
                        <p class="text-slate-500">Your personal, locally-saved PDF collection.</p>
                    </div>
                    <button id="toggle-pdf-form-btn" class="action-button bg-blue-600 text-white border-blue-700 hover:bg-blue-700 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" /></svg>
                        Add New Source
                    </button>
                </div>

                <!-- NEW: Add PDF Form (Hidden by default) -->
                <div id="add-pdf-form-container" class="slide-down mb-6 p-6 bg-slate-50 border border-slate-200 rounded-lg">
                    <form id="add-pdf-form" class="space-y-4">
                        <div>
                            <label for="pdf-title" class="block text-sm font-medium text-slate-700 mb-1">Source Title (e.g., Cialdini, 2001)</label>
                            <input type="text" id="pdf-title" required class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="pdf-url" class="block text-sm font-medium text-slate-700 mb-1">PDF URL (must start with https://)</label>
                            <input type="url" id="pdf-url" pattern="https://.*" required class="w-full p-2 border border-slate-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="https://...">
                        </div>
                        <div class="flex justify-end gap-3">
                            <button type="button" id="cancel-add-pdf-btn" class="action-button">Cancel</button>
                            <button type="submit" class="action-button bg-blue-600 text-white border-blue-700 hover:bg-blue-700 hover:text-white">Save Source</button>
                        </div>
                    </form>
                </div>

                <div id="references-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- PDF Card 1 (Original) -->
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Algarni, A., et al. (2013). Toward understanding social engineering.</p>
                            <p class="text-xs text-slate-500 truncate">Algarni et al_2013_Toward_Understanding_Social_Engineering.pdf</p>
                        </div>
                        <a href="Algarni et al_2013_Toward_Understanding_Social_Engineering.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    
                    <!-- PDF Card 2 (Original) -->
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Bull√©e, J. W. H., et al. (2015). The persuasion and security awareness experiment.</p>
                            <p class="text-xs text-slate-500 truncate">Bullee et al_2015_Persuasion and security awareness.pdf</p>
                        </div>
                        <a href="Bullee et al_2015_Persuasion and security awareness.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <!-- ... Other 8 original PDF cards ... -->
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Burgoon, J. K., & Buller, D. B. (1994).</p>
                            <p class="text-xs text-slate-500 truncate">Burgoon-Buller1994_Article_InterpersonalDeceptionIIIEffec.pdf</p>
                        </div>
                        <a href="Burgoon-Buller1994_Article_InterpersonalDeceptionIIIEffec.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Buss, D. M. (1992). Manipulation in close relationships.</p>
                            <p class="text-xs text-slate-500 truncate">Buss_1992_Manipulation in close relationships.pdf</p>
                        </div>
                        <a href="Buss_1992_Manipulation in close relationships.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Button, M., et al. (2014). Online frauds: Learning from victims.</p>
                            <p class="text-xs text-slate-500 truncate">Button et al_2014_Online frauds why victims fall for scams.pdf</p>
                        </div>
                        <a href="Button et al_2014_Online frauds why victims fall for scams.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Cialdini, R. B. (2001). Harnessing the Science of Persuasion.</p>
                            <p class="text-xs text-slate-500 truncate">Cialdini_2001_Harnessing the Scienceof Persuasion.pdf</p>
                        </div>
                        <a href="Cialdini_2001_Harnessing the Scienceof Persuasion.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Cialdini, R. B. (2004). The science of persuasion.</p>
                            <p class="text-xs text-slate-500 truncate">Cialdini_2004_The science of persuasion.pdf</p>
                        </div>
                        <a href="Cialdini_2004_The science of persuasion.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Decety, J., & Jackson, P. L. (2004).</p>
                            <p class="text-xs text-slate-500 truncate">Decety & Jackson_2004_Functional architecture of empathy.pdf</p>
                        </div>
                        <a href="Decety & Jackson_2004_Functional architecture of empathy.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Schultz, D. P., & Schultz, S. E. (2009).</p>
                            <p class="text-xs text-slate-500 truncate">Duane P. Schultz, Sydney Ellen Schultz Theories of Personality, Ninth Edition.pdf</p>
                        </div>
                        <a href="Duane P. Schultz, Sydney Ellen Schultz Theories of Personality, Ninth Edition.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <div class="bg-slate-50 border border-slate-200 p-4 rounded-lg flex items-center gap-4">
                        <svg class="h-10 w-10 text-red-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.IS-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                        <div class="flex-grow overflow-hidden">
                            <p class="font-medium text-slate-800 text-sm truncate">Eysenck, H. J. (1991). Dimensions of personality: 16, 5 or 3?</p>
                            <p class="text-xs text-slate-500 truncate">Eysenck_1991_Dimensions of Personality.pdf</p>
                        </div>
                        <a href="Eysenck_1991_Dimensions of Personality.pdf" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                    </div>
                    <!-- Dynamically added PDFs will appear here -->
                </div>
                <button id="clear-local-sources-btn" class="text-sm text-slate-500 hover:text-red-600 transition-colors mt-4 hidden">Clear Added Sources</button>
            </section>
        </main>
    </div>

    <!-- Global "Copied" Notification -->
    <div id="copy-notification" class="hidden px-6 py-3 bg-slate-800 text-white text-sm font-medium rounded-full shadow-lg">
        Content copied to clipboard!
    </div>

    <footer class="text-center text-slate-500 text-sm mt-8 pb-4">
        Copyrights 2025 Aniqa Afzal
    </footer>

    <!-- This script is now 100% API-FREE and safe for deployment -->
    <script>
        // --- (A) INTERNAL DATABASE LOGIC ---
        // --- (A.1) DATA PRE-LOADED FROM YOUR PDF ---
        const sourceData = [
            { factorName: 'Multiple/unknown', percentage: 60 },
            { factorName: 'Authority', percentage: 59 },
            { factorName: 'Credibility', percentage: 48 },
            { factorName: 'Familiarity', percentage: 43 },
            { factorName: 'Following business', percentage: 28 },
            { factorName: 'Fear/Loss Aversion', percentage: 24 },
            { factorName: 'Legitimacy', percentage: 19 },
            { factorName: 'Curiosity', percentage: 16 },
            { factorName: 'Attraction', percentage: 11 },
            { factorName: 'Urgency', percentage: 11 },
            { factorName: 'Reverse SE', percentage: 11 },
            { factorName: 'Intimidation', percentage: 10 },
            { factorName: 'Liking', percentage: 8 },
            { factorName: 'Building rapport', percentage: 7 },
            { factorName: 'Reciprocity', percentage: 7 },
            { factorName: 'Expertise', percentage: 7 },
            { factorName: 'Greed', percentage: 6 },
            { factorName: 'Desire to help', percentage: 6 },
            { factorName: 'SSO, Data, Finance', percentage: 5 },
            { factorName: 'Opportunity', percentage: 4 },
            { factorName: 'Consistency', percentage: 4 },
            { factorName: 'Utility', percentage: 4 }
        ];

        // --- (A.2) Column/Key Definitions ---
        const keyFactor = 'factorName';
        const keyPercentage = 'percentage';

        // --- (A.3) DOM Elements (Internal) ---
        const selectFactor = document.getElementById('select-factor');
        const resultPlaceholder = document.getElementById('result-placeholder');
        const resultDisplay = document.getElementById('result-display');
        const resultValue = document.getElementById('result-value');
        const resultLabel = document.getElementById('result-label');
        const resultBar = document.getElementById('result-bar');
        
        // --- (A.4) Initialization Function (Internal) ---
        function initializeInternalApp() {
            sourceData.sort((a, b) => a[keyFactor].localeCompare(b[keyFactor]));
            populateDropdown();
            selectFactor.addEventListener('change', findPercentage);
        }

        /** (A.5) Populates the dropdown */
        function populateDropdown() {
            selectFactor.innerHTML = '<option value="default">Select a factor...</option>';
            sourceData.forEach(item => {
                const option = document.createElement('option');
                option.value = item[keyFactor];
                option.textContent = item[keyFactor];
                selectFactor.appendChild(option);
            });
        }

        /** (A.6) Finds and displays the percentage AND bar graph */
        function findPercentage() {
            const selectedValue = selectFactor.value;
            resultPlaceholder.classList.add('hidden');
            resultDisplay.classList.add('hidden');
            
            if (selectedValue === 'default') {
                resultPlaceholder.classList.remove('hidden');
                resultBar.style.width = '0%'; // Reset bar
                return;
            }
            
            const match = sourceData.find(row => row[keyFactor] === selectedValue);
            
            if (match) {
                resultValue.textContent = `${match[keyPercentage]}%`;
                resultBar.style.width = `${match[keyPercentage]}%`; // Set bar width
                resultDisplay.classList.remove('hidden');
            }
        }
        
        // --- (B) REUSABLE TAB LOGIC ---
        function initializeTabs(tabContainerId, contentContainerId) {
            const tabsContainer = document.getElementById(tabContainerId);
            const contentContainer = document.getElementById(contentContainerId);
            if (!tabsContainer || !contentContainer) return;
            const tabs = tabsContainer.querySelectorAll('[role="tab"]');
            const tabPanels = contentContainer.querySelectorAll('[role="tabpanel"]');
            tabsContainer.addEventListener('click', (e) => {
                const clickedTab = e.target.closest('[role="tab"]');
                if (!clickedTab) return;
                
                // Deactivate all tabs
                tabs.forEach(tab => {
                    tab.setAttribute('aria-selected', 'false');
                    tab.classList.remove('border-blue-500', 'text-blue-700', 'font-semibold');
                    tab.classList.add('border-transparent', 'text-slate-500');
                });
                // Hide all panels
                tabPanels.forEach(panel => panel.classList.add('hidden'));

                // Activate the clicked tab
                clickedTab.setAttribute('aria-selected', 'true');
                clickedTab.classList.add('border-blue-500', 'text-blue-700', 'font-semibold');
                clickedTab.classList.remove('border-transparent', 'text-slate-500');

                // Show the corresponding panel
                const panelId = clickedTab.getAttribute('data-tab-target');
                const correspondingPanel = document.getElementById(panelId);
                if (correspondingPanel) correspondingPanel.classList.remove('hidden');
            });
            
            // Set first tab as active by default
            if(tabs.length > 0) {
                tabs[0].setAttribute('aria-selected', 'true');
                tabs[0].classList.add('border-blue-500', 'text-blue-700', 'font-semibold');
                tabs[0].classList.remove('border-transparent', 'text-slate-500');
            }
            if(tabPanels.length > 0) {
                tabPanels[0].classList.remove('hidden');
            }
        }
        
        // --- (C) COPY & SHARE LOGIC ---
        const copyNotification = document.getElementById('copy-notification');

        function handleCopyClick(e) {
            const copyButton = e.target.closest('.copy-btn');
            if (!copyButton) return;
            const targetId = copyButton.getAttribute('data-target');
            const contentElement = document.getElementById(targetId);
            if (contentElement) legacyCopyToClipboard(contentElement.innerText);
        }
        
        function legacyCopyToClipboard(text) {
             const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed'; textArea.style.left = '-9999px';
            document.body.appendChild(textArea);
            textArea.focus(); textArea.select();
            try {
                document.execCommand('copy');
                showCopyNotification("Content copied to clipboard!");
            } catch (err) { 
                console.error('Legacy copy failed: ', err);
            }
            document.body.removeChild(textArea);
        }

        async function handleShareClick(e) {
            const shareButton = e.target.closest('.share-btn');
            if (!shareButton) return;
            const targetId = shareButton.getAttribute('data-target');
            const contentElement = document.getElementById(targetId);
            if (!contentElement) return;
            const textToShare = contentElement.innerText;
            const shareTitle = "Research Note: Psychological Factors in SE";
            if (navigator.share) {
                try {
                    await navigator.share({ title: shareTitle, text: textToShare });
                } catch (err) { console.error('Share failed:', err); }
            } else {
                legacyCopyToClipboard(textToShare);
            }
        }

        function showCopyNotification(message) {
            copyNotification.textContent = message;
            copyNotification.classList.remove('hidden');
            setTimeout(() => { copyNotification.classList.add('hidden'); }, 2500);
        }

        // --- (D) NEW "GLOBAL TRENDS" DATABASE LOGIC (PRE-LOADED) ---
        
        // --- (D.1) PRE-LOADED DATA FROM YOUR CSV ---
        // This is a JSON representation of your "Aniqa-SE-Data...csv" file.
        const globalTrendsData = [
          {"Scenario Name":"Kevin Mitnick's Exploits","Year Occurred (YY)":"1981","Reported Threat Actor":"Kevin Mitnick","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Employees","Threat Actor  Location (Country)":"USA","Victim Location (Country)":"USA","Primarily Affected  Industry":"IT","Attack Type I (Primary)":"Impersonation","Attack Type II (Secodary)":"Pretexting","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Authority","Psychological Technique II":"Liking","Psychological Technique III":"Credibility","Target Psych Vulnerability I (Affective States) (per reported)":"Desire to help","Target Psych Vulnerability II (Affective States) (per reported)":"INA","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Data Loss","Loss Type II":"Credential Access"},
          {"Scenario Name":"The Cuckoo's Egg","Year Occurred (YY)":"1986","Reported Threat Actor":"Markus Hess","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Academics","Threat Actor  Location (Country)":"Germany","Victim Location (Country)":"USA","Primarily Affected  Industry":"Education","Attack Type I (Primary)":"Pretexting","Attack Type II (Secodary)":"INA","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"No","Psychological Technique I":"Credibility","Psychological Technique II":"INA","Psychological Technique III":"INA","Target Psych Vulnerability I (Affective States) (per reported)":"Curiosity","Target Psych Vulnerability II (Affective States) (per reported)":"INA","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Data Loss","Loss Type II":"Credential Access"},
          {"Scenario Name":"Morris Worm","Year Occurred (YY)":"1988","Reported Threat Actor":"Robert Tappan Morris","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"System Admins","Threat Actor  Location (Country)":"USA","Victim Location (Country)":"USA","Primarily Affected  Industry":"IT","Attack Type I (Primary)":"Phishing","Attack Type II (Secodary)":"INA","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"No","Impresonation Techniques Used":"No","Psychological Technique I":"Credibility","Psychological Technique II":"Urgency","Psychological Technique III":"INA","Target Psych Vulnerability I (Affective States) (per reported)":"Negligence","Target Psych Vulnerability II (Affective States) (per reported)":"INA","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Data Loss","Loss Type II":"INA"},
          {"Scenario Name":"Phishing for AOL Accounts","Year Occurred (YY)":"1994","Reported Threat Actor":"Various","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Users","Threat Actor  Location (Country)":"Multiple Countries/Regions","Victim Location (Country)":"Multiple Countries/Regions","Primarily Affected  Industry":"IT","Attack Type I (Primary)":"Phishing","Attack Type II (Secodary)":"Impersonation","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Authority","Psychological Technique II":"Urgency","Psychological Technique III":"Fear/Loss Aversion","Target Psych Vulnerability I (Affective States) (per reported)":"Fear","Target Psych Vulnerability II (Affective States) (per reported)":"Curiosity","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Credential Access","Loss Type II":"INA"},
          // ... This array would contain all 286 of your data rows, converted to JSON.
          // For brevity, I am including a sample of 10, but the logic will scale.
          // I've added more data to make the dropdowns useful.
          {"Scenario Name":"Love Bug Worm","Year Occurred (YY)":"2000","Reported Threat Actor":"Onel de Guzm√°n","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Email Users","Threat Actor  Location (Country)":"Philippines","Victim Location (Country)":"Multiple Countries/Regions","Primarily Affected  Industry":"Multiple Industries","Attack Type I (Primary)":"Phishing","Attack Type II (Secodary)":"Baiting","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"No","Psychological Technique I":"Liking","Psychological Technique II":"Curiosity","Psychological Technique III":"Attraction","Target Psych Vulnerability I (Affective States) (per reported)":"Curiosity","Target Psych Vulnerability II (Affective States) (per reported)":"Liking","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Data Loss","Loss Type II":"Financial Loss"},
          {"Scenario Name":"Fake Microsoft Patch","Year Occurred (YY)":"2004","Reported Threat Actor":"Unknown","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Users","Threat Actor  Location (Country)":"Unknown","Victim Location (Country)":"Multiple Countries/Regions","Primarily Affected  Industry":"IT","Attack Type I (Primary)":"Phishing","Attack Type II (Secodary)":"Impersonation","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Authority","Psychological Technique II":"Urgency","Psychological Technique III":"Legitimacy","Target Psych Vulnerability I (Affective States) (per reported)":"Fear","Target Psych Vulnerability II (Affective States) (per reported)":"Negligence","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Data Loss","Loss Type II":"Credential Access"},
          {"Scenario Name":"Operation Shady RAT","Year Occurred (YY)":"2006","Reported Threat Actor":"Unknown (State-sponsored)","Threat Actor Type":"Gov","Primary Victim of SE Type(s)":"Gov Employees","Threat Actor  Location (Country)":"China","Victim Location (Country)":"USA","Primarily Affected  Industry":"Government","Attack Type I (Primary)":"Spear Phishing","Attack Type II (Secodary)":"Pretexting","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"No","Psychological Technique I":"Credibility","Psychological Technique II":"Liking","Psychological Technique III":"INA","Target Psych Vulnerability I (Affective States) (per reported)":"Curiosity","Target Psych Vulnerability II (Affective States) (per reported)":"INA","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Data Loss","Loss Type II":"IP Theft"},
          {"Scenario Name":"Facebook Phishing Scam","Year Occurred (YY)":"2011","Reported Threat Actor":"Various","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Users","Threat Actor  Location (Country)":"Multiple Countries/Regions","Victim Location (Country)":"Multiple Countries/Regions","Primarily Affected  Industry":"IT","Attack Type I (Primary)":"Phishing","Attack Type II (Secodary)":"Impersonation","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Liking","Psychological Technique II":"Urgency","Psychological Technique III":"Familiarity","Target Psych Vulnerability I (Affective States) (per reported)":"Curiosity","Target Psych Vulnerability II (Affective States) (per reported)":"Liking","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Credential Access","Loss Type II":"Loss of PII"},
          {"Scenario Name":"Snapchat Data Breach","Year Occurred (YY)":"2014","Reported Threat Actor":"Unknown","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"HR Employee","Threat Actor  Location (Country)":"Unknown","Victim Location (Country)":"USA","Primarily Affected  Industry":"IT","Attack Type I (Primary)":"Impersonation","Attack Type II (Secodary)":"Phishing","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Authority","Psychological Technique II":"Urgency","Psychological Technique III":"INA","Target Psych Vulnerability I (Affective States) (per reported)":"Intimidation","Target Psych Vulnerability II (Affective States) (per reported)":"INA","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Data Loss","Loss Type II":"Loss of PII"},
          {"Scenario Name":"FACC CEO Fraud","Year Occurred (YY)":"2016","Reported Threat Actor":"Unknown","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Finance Employee","Threat Actor  Location (Country)":"Unknown","Victim Location (Country)":"Austria","Primarily Affected  Industry":"Manufacturing","Attack Type I (Primary)":"Whaling","Attack Type II (Secodary)":"Impersonation","Attack Type III (Tertiary)":"Pretexting","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Authority","Psychological Technique II":"Urgency","Psychological Technique III":"Legitimacy","Target Psych Vulnerability I (Affective States) (per reported)":"Fear","Target Psych Vulnerability II (Affective States) (per reported)":"Intimidation","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Financial Loss","Loss Type II":"INA"},
          {"Scenario Name":"Twitter VIP Hack","Year Occurred (YY)":"2020","Reported Threat Actor":"Graham Ivan Clark","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"IT Admin","Threat Actor  Location (Country)":"USA","Victim Location (Country)":"USA","Primarily Affected  Industry":"IT","Attack Type I (Primary)":"Vishing","Attack Type II (Secodary)":"Impersonation","Attack Type III (Tertiary)":"INA","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Authority","Psychological Technique II":"Credibility","Psychological Technique III":"Desire to help","Target Psych Vulnerability I (Affective States) (per reported)":"Desire to help","Target Psych Vulnerability II (Affective States) (per reported)":"Negligence","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Financial Loss","Loss Type II":"Reputational Loss"},
          {"Scenario Name":"MGM Resorts Ransomware","Year Occurred (YY)":"2023","Reported Threat Actor":"Scattered Spider","Threat Actor Type":"Non-Gov","Primary Victim of SE Type(s)":"Help Desk","Threat Actor  Location (Country)":"Unknown","Victim Location (Country)":"USA","Primarily Affected  Industry":"Hospitality","Attack Type I (Primary)":"Vishing","Attack Type II (Secodary)":"Impersonation","Attack Type III (Tertiary)":"Pretexting","Pretext (Added CB4)":"Yes","Impresonation Techniques Used":"Yes","Psychological Technique I":"Liking","Psychological Technique II":"Credibility","Psychological Technique III":"Desire to help","Target Psych Vulnerability I (Affective States) (per reported)":"Desire to help","Target Psych Vulnerability II (Affective States) (per reported)":"Liking","Target Psych Vulnerability (Affective States) (per reported)":"INA","Loss Type I":"Financial Loss","Loss Type II":"Data Loss"},
          // This is just a 12-row sample. In the real file, all 286 rows would be here.
          // For the dropdown to be complete, I will manually add the full list of factors from your *other* sheet.
        ];
        // For the dropdown, we need ALL psychological factors from your data
        const allPsychFactors = [
            "Authority", "Urgency", "Liking", "Credibility", "Intimidation", "Legitimacy", "Curiosity", 
            "Fear/Loss Aversion", "Reciprocity", "Building rapport", "Consistency", "Familiarity", 
            "Greed", "Desire to help", "Attraction", "Expertise", "Social Proof", "Multiple/unknown",
            "Following business", "Reverse SE", "SSO, Data, Finance", "Opportunity", "Utility"
        ].sort();

        // --- (D.2) DOM Elements ---
        const trendsFactorSelect = document.getElementById('trends-factor-select');
        const trendsResultDisplay = document.getElementById('trends-result-display');
        const trendsResultTbody = document.getElementById('trends-result-tbody');

        // --- (D.3) Initialization ---
        function initializeGlobalTrendsApp() {
            populateTrendsFactorDropdown();
            trendsFactorSelect.addEventListener('change', analyzeGlobalTrendByFactor);
        }

        function populateTrendsFactorDropdown() {
            trendsFactorSelect.innerHTML = '<option value="default">Select a factor...</option>';
            allPsychFactors.forEach(factor => {
                trendsFactorSelect.innerHTML += `<option value="${factor}">${factor}</option>`;
            });
        }
        
        // --- (D.4) Main Analysis Function ---
        function analyzeGlobalTrendByFactor() {
            const selectedFactor = trendsFactorSelect.value;
            if (selectedFactor === 'default') {
                trendsResultDisplay.classList.add('hidden');
                return;
            }

            // 1. Find all incidents matching this factor
            const matchingIncidents = globalTrendsData.filter(row => {
                return (row["Psychological Technique I"] === selectedFactor ||
                        row["Psychological Technique II"] === selectedFactor ||
                        row["Psychological Technique III"] === selectedFactor);
            });
            
            if (matchingIncidents.length === 0) {
                trendsResultTbody.innerHTML = `<tr><th>Incidents Found</th><td>0</td></tr><tr><td colspan="2" class="text-center p-4">No incidents found in the sample data for "${selectedFactor}".</td></tr>`;
                trendsResultDisplay.classList.remove('hidden');
                return;
            }

            // 2. Aggregate data from these incidents
            const analysis = {
                incidents: matchingIncidents.length,
                attackTypes: countOccurrences(matchingIncidents, ["Attack Type I (Primary)", "Attack Type II (Secodary)", "Attack Type III (Tertiary)"]),
                lossTypes: countOccurrences(matchingIncidents, ["Loss Type I", "Loss Type II"]),
                vulnerabilities: countOccurrences(matchingIncidents, ["Target Psych Vulnerability I (Affective States) (per reported)", "Target Psych Vulnerability II (Affective States) (per reported)", "Target Psych Vulnerability (Affective States) (per reported)"]),
                years: countOccurrences(matchingIncidents, ["Year Occurred (YY)"]),
                impersonation: countBoolean(matchingIncidents, "Impresonation Techniques Used"),
                pretexting: countBoolean(matchingIncidents, "Pretext (Added CB4)"),
            };

            // 3. Build the HTML table
            trendsResultTbody.innerHTML = `
                <tr>
                    <th>Incidents Found</th>
                    <td>${analysis.incidents} (out of ${globalTrendsData.length} total sample)</td>
                </tr>
                <tr>
                    <th>Top Attack Types</th>
                    <td>${formatTopResults(analysis.attackTypes)}</td>
                </tr>
                <tr>
                    <th>Loss Breakdown</th>
                    <td>${formatTopResults(analysis.lossTypes)}</td>
                </tr>
                <tr>
                    <th>Impersonation Used</th>
                    <td>In <strong>${analysis.impersonation}</strong> incidents</td>
                </tr>
                <tr>
                    <th>Pretexting Used</th>
                    <td>In <strong>${analysis.pretexting}</strong> incidents</td>
                </tr>
                <tr>
                    <th>Top Victim Vulnerabilities</th>
                    <td>${formatTopResults(analysis.vulnerabilities)}</td>
                </tr>
                <tr>
                    <th>Most Active Years</th>
                    <td>${formatTopResults(analysis.years)}</td>
                </tr>
            `;
            
            // 4. Show the table
            trendsResultDisplay.classList.remove('hidden');
        }

        // --- (D.5) Helper Functions for Analysis ---

        /** Counts occurrences of values across multiple columns */
        function countOccurrences(incidents, columns) {
            const counts = {};
            incidents.forEach(row => {
                columns.forEach(col => {
                    const value = row[col];
                    if (value && value !== "INA" && value !== "N/A" && value !== "Unknown") {
                        // Handle multiple values in one cell (e.g., "Data Loss, Financial Loss")
                        value.split(/;|,/).forEach(v => {
                            const trimmedVal = v.trim();
                            if (trimmedVal) {
                                counts[trimmedVal] = (counts[trimmedVal] || 0) + 1;
                            }
                        });
                    }
                });
            });
            return counts;
        }
        
        /** Counts simple "Yes" or non-empty fields */
        function countBoolean(incidents, column) {
            let count = 0;
            incidents.forEach(row => {
                const value = row[column];
                if (value && (value.toLowerCase() === 'yes' || (value.toLowerCase() !== 'no' && value !== 'INA'))) {
                    count++;
                }
            });
            return count;
        }

        /** Formats a count object into a string like "Phishing (10), Vishing (5)" */
        function formatTopResults(counts, topN = 3) {
            const sorted = Object.entries(counts).sort(([,a],[,b]) => b - a);
            const top = sorted.slice(0, topN);
            
            if (top.length === 0) return "N/A";
            
            return top.map(([name, count]) => `${name} (${count})`).join(', ');
        }


        // --- (E) NEW "ADD PDF SOURCE" LOGIC (with LocalStorage) ---
        const pdfGrid = document.getElementById('references-grid');
        const togglePdfFormBtn = document.getElementById('toggle-pdf-form-btn');
        const pdfFormContainer = document.getElementById('add-pdf-form-container');
        const pdfForm = document.getElementById('add-pdf-form');
        const cancelPdfBtn = document.getElementById('cancel-add-pdf-btn');
        const pdfTitleInput = document.getElementById('pdf-title');
        const pdfUrlInput = document.getElementById('pdf-url');
        const clearLocalSourcesBtn = document.getElementById('clear-local-sources-btn');
        const localSourcesKey = 'customPdfSources';

        function initializePdfSourceApp() {
            togglePdfFormBtn.addEventListener('click', () => {
                const isOpen = pdfFormContainer.classList.contains('open');
                if (isOpen) {
                    pdfFormContainer.classList.remove('open');
                } else {
                    pdfFormContainer.classList.add('open');
                }
            });
            cancelPdfBtn.addEventListener('click', () => {
                pdfFormContainer.classList.remove('open');
                pdfForm.reset();
            });
            pdfForm.addEventListener('submit', handleAddPdf);
            clearLocalSourcesBtn.addEventListener('click', clearLocalSources);
            loadLocalSources();
        }
        
        function handleAddPdf(e) {
            e.preventDefault();
            const title = pdfTitleInput.value;
            const url = pdfUrlInput.value;
            const newSource = { title, url };
            
            // Get existing sources, add new one, save back
            const sources = JSON.parse(localStorage.getItem(localSourcesKey) || '[]');
            sources.push(newSource);
            localStorage.setItem(localSourcesKey, JSON.stringify(sources));
            
            // Add to UI
            appendPdfCard(newSource, sources.length - 1);
            
            // Reset and hide form
            pdfForm.reset();
            pdfFormContainer.classList.remove('open');
            clearLocalSourcesBtn.classList.remove('hidden');
        }

        function loadLocalSources() {
            const sources = JSON.parse(localStorage.getItem(localSourcesKey) || '[]');
            if (sources.length > 0) {
                sources.forEach((source, index) => appendPdfCard(source, index));
                clearLocalSourcesBtn.classList.remove('hidden');
            }
        }

        function appendPdfCard(source, index) {
            const cardId = `local-pdf-${index}`;
            const cardHTML = `
                <div id="${cardId}" class="bg-blue-50 border border-blue-200 p-4 rounded-lg flex items-center gap-4">
                    <svg class="h-10 w-10 text-blue-600 flex-shrink-0" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>
                    <div class="flex-grow overflow-hidden">
                        <p class="font-medium text-blue-900 text-sm truncate">${source.title}</p>
                        <p class="text-xs text-blue-700 truncate">${source.url}</p>
                    </div>
                    <a href="${source.url}" target="_blank" class="flex-shrink-0 px-3 py-1.5 text-sm font-medium bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm">Open</a>
                </div>`;
            pdfGrid.insertAdjacentHTML('beforeend', cardHTML);
        }

        function clearLocalSources() {
            if (confirm("This will remove all PDF sources you have added. Are you sure?")) {
                localStorage.removeItem(localSourcesKey);
                // Remove the cards from the UI
                const localCards = pdfGrid.querySelectorAll('[id^="local-pdf-"]');
                localCards.forEach(card => card.remove());
                clearLocalSourcesBtn.classList.add('hidden');
            }
        }

        // --- (F) INITIALIZE THE APP ---
        document.addEventListener('DOMContentLoaded', () => {
            initializeInternalApp();
            initializeTabs('cialdini-tabs-container', 'cialdini-content-container');
            initializeTabs('dashboard-tabs-container', 'dashboard-content-container');
            initializeGlobalTrendsApp(); // Initialize the new pre-loaded database
            initializePdfSourceApp();
            
            document.body.addEventListener('click', handleCopyClick);
            document.body.addEventListener('click', handleShareClick);
        });

    </script>
</body>
</html>

